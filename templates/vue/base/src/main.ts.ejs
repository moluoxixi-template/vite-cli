/**
 * 应用入口文件 - 标准模式
 * 初始化 Vue 应用并挂载到 DOM
 */

import { createApp } from 'vue'
import directives from '@/directives'
<% if (i18n) { -%>
import i18n from '@/locales'
<% } -%>
<% if (sentry) { -%>
import { initSentry } from '@/utils/sentry'
<% } -%>
<% if (pinia) { -%>
import { store } from '@/stores'
<% } -%>
import App from './App.vue'
<% if (hasRouter) { -%>
import getRouter from './router'
<% } -%>

// 导入样式文件
<% if (uiLibrary === 'element-plus') { -%>
import '@/assets/styles/element/index.scss'
<% } -%>
import '@/assets/styles/main.scss'
import '@/assets/fonts/index.css'

/**
 * 初始化并渲染应用
 */
async function initApp(): Promise<void> {
  const app = createApp(App)

  directives(app)
<% if (hasRouter) { -%>
  const router = getRouter()

<% } -%>
<% if (sentry) { -%>
  initSentry(app<% if (hasRouter) { %>, router<% } %>, {
    dsn: import.meta.env.VITE_SENTRY_DSN,
    environment: import.meta.env.MODE,
  })

<% } -%>
<% if (pinia) { -%>
  app.use(store)
<% } -%>
<% if (i18n) { -%>
  app.use(i18n)
<% } -%>
<% if (hasRouter) { -%>
  app.use(router)
<% } -%>
  app.config.warnHandler = () => null

  app.mount('#app')
}

initApp()
